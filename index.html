<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Workout Tracker Pro</title>
<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  margin: 0;
  background: #111;
  color: white;
}
.container { padding: 20px; }
button {
  padding: 10px;
  margin: 5px 0;
  background: #2a2a2a;
  color: white;
  border: none;
  border-radius: 8px;
  width: 100%;
}
input {
  padding: 8px;
  margin: 4px 0;
  border-radius: 6px;
  border: none;
  width: 100%;
}
.card {
  background: #1c1c1c;
  padding: 10px;
  margin: 8px 0;
  border-radius: 10px;
}
.timer {
  font-size: 28px;
  text-align: center;
  margin: 10px 0;
}
.small-btn {
  width: auto;
  padding: 5px 10px;
  font-size: 12px;
}
h3 { margin-bottom: 5px; }
</style>
</head>
<body>
<div class="container" id="app"></div>

<script>

// ---------- DEFAULT TEMPLATES ----------

const defaultTemplates = [
{
name:"Upper 1 ‚Äì Pull Dominant",
rest:120,
exercises:[
{name:"Vertical Pull (Wide Grip)",sets:2},
{name:"Horizontal Row",sets:2},
{name:"Vertical Pull (Close / Neutral)",sets:2},
{name:"Incline Press (60¬∞)",sets:2},
{name:"Lateral Raises",sets:2},
{name:"Optional Arms",sets:2}
]
},
{
name:"Lower 1 ‚Äì Quad Emphasis",
rest:120,
exercises:[
{name:"Quad Dominant Squat",sets:3},
{name:"Bulgarian Split Squats (Shorter Stride)",sets:3},
{name:"Romanian Deadlift",sets:3},
{name:"Hip Thrust",sets:3}
]
},
{
name:"Upper 2 ‚Äì Push Dominant",
rest:120,
exercises:[
{name:"Overhead Press",sets:2},
{name:"Incline Press (60¬∞)",sets:2},
{name:"Lateral Raises",sets:2},
{name:"Horizontal Row (Different Variation)",sets:2},
{name:"Vertical Pull (Neutral or Supinated)",sets:2},
{name:"Optional Arms",sets:2}
]
},
{
name:"Lower 2 ‚Äì Glute / Hinge Emphasis",
rest:120,
exercises:[
{name:"Romanian Deadlift (Primary Hinge)",sets:3},
{name:"Hip Thrust (Heavier Than Lower 1)",sets:3},
{name:"Glute Dominant Squat",sets:3},
{name:"Bulgarian Split Squats (Longer Stride)",sets:3}
]
}
];

// ---------- LOAD DATA SAFELY ----------

let stored = JSON.parse(localStorage.getItem("workoutPro"));

let data = stored && stored.templates?.length
? stored
: {
templates: defaultTemplates,
workouts: [],
activeWorkout:null
};

function save(){
localStorage.setItem("workoutPro",JSON.stringify(data));
}

// ---------- HOME ----------

function renderHome(){
const app=document.getElementById("app");
app.innerHTML=`
<h2>Workout Templates</h2>
<button onclick="createTemplate()">+ Create Template</button>
<button onclick="viewHistory()">üìä View Workout History</button>
${data.templates.map((t,i)=>`
<div class="card">
<b>${t.name}</b><br>
<button onclick="startWorkout(${i})">Start Workout</button>
<button onclick="editTemplate(${i})">Edit</button>
</div>
`).join("")}
`;
}

// ---------- TEMPLATE ----------

function createTemplate(){
const name=prompt("Template Name:");
if(!name)return;
data.templates.push({name,rest:120,exercises:[]});
save(); renderHome();
}

function editTemplate(i){
const t=data.templates[i];
const app=document.getElementById("app");
app.innerHTML=`
<button onclick="renderHome()">‚Üê Back</button>
<h2>${t.name}</h2>
<label>Rest (seconds)</label>
<input value="${t.rest}" onchange="t.rest=this.value;save()">
<h3>Exercises</h3>
${t.exercises.map((e,ei)=>`
<div class="card">
<input value="${e.name}" onchange="updateExerciseName(${i},${ei},this.value)">
<label>Sets</label>
<input value="${e.sets}" onchange="updateExerciseSets(${i},${ei},this.value)">
<button class="small-btn" onclick="moveUp(${i},${ei})">‚Üë</button>
<button class="small-btn" onclick="moveDown(${i},${ei})">‚Üì</button>
<button class="small-btn" onclick="deleteExercise(${i},${ei})">Delete</button>
</div>
`).join("")}
<button onclick="addExercise(${i})">+ Add Exercise</button>
`;
}

function updateExerciseName(i,ei,val){
data.templates[i].exercises[ei].name=val;
save();
}
function updateExerciseSets(i,ei,val){
data.templates[i].exercises[ei].sets=parseInt(val);
save();
}
function addExercise(i){
const name=prompt("Exercise Name:");
if(!name)return;
data.templates[i].exercises.push({name,sets:2});
save(); editTemplate(i);
}
function deleteExercise(i,ei){
data.templates[i].exercises.splice(ei,1);
save(); editTemplate(i);
}
function moveUp(i,ei){
if(ei===0)return;
let ex=data.templates[i].exercises;
[ex[ei-1],ex[ei]]=[ex[ei],ex[ei-1]];
save(); editTemplate(i);
}
function moveDown(i,ei){
let ex=data.templates[i].exercises;
if(ei===ex.length-1)return;
[ex[ei+1],ex[ei]]=[ex[ei],ex[ei+1]];
save(); editTemplate(i);
}

// ---------- WORKOUT ----------

function startWorkout(i){
const template=JSON.parse(JSON.stringify(data.templates[i]));
template.current=0;
template.logs=template.exercises.map(e=>({
name:e.name,
sets:Array.from({length:e.sets},()=>({weight:"",reps:""}))
}));
template.startTime=new Date();
data.activeWorkout=template;
save(); renderWorkout();
}

let timerInt=null;

function renderWorkout(){
const w=data.activeWorkout;
if(!w)return renderHome();
const ex=w.logs[w.current];
const app=document.getElementById("app");

app.innerHTML=`
<button onclick="finishWorkout()">Finish Workout</button>
<h2>${ex.name}</h2>
${ex.sets.map((s,si)=>`
<div class="card">
Set ${si+1}
<input placeholder="Weight" value="${s.weight}"
onchange="updateSet(${si},'weight',this.value)">
<input placeholder="Reps" value="${s.reps}"
onchange="updateSet(${si},'reps',this.value)">
<button onclick="completeSet(${si})">Complete</button>
</div>
`).join("")}
<div class="timer" id="timer"></div>
<button onclick="prevExercise()">‚Üê Previous</button>
<button onclick="nextExercise()">Next ‚Üí</button>
`;
}

function updateSet(si,key,val){
data.activeWorkout.logs[data.activeWorkout.current].sets[si][key]=val;
save();
}

function completeSet(si){
let set=data.activeWorkout.logs[data.activeWorkout.current].sets[si];
if(parseInt(set.reps)>15){
alert("More than 15 reps. Increase weight.");
return;
}
startTimer(data.activeWorkout.rest||120);
}

function startTimer(sec){
clearInterval(timerInt);
let remain=sec;
const t=document.getElementById("timer");
t.innerText=format(remain);
timerInt=setInterval(()=>{
remain--;
t.innerText=format(remain);
if(remain<=0){
clearInterval(timerInt);
alert("Rest finished");
}
},1000);
}
function format(s){
let m=Math.floor(s/60);
let sec=s%60;
return m+":"+(sec<10?"0":"")+sec;
}

function nextExercise(){
if(data.activeWorkout.current<
data.activeWorkout.logs.length-1){
data.activeWorkout.current++;
save(); renderWorkout();
}
}
function prevExercise(){
if(data.activeWorkout.current>0){
data.activeWorkout.current--;
save(); renderWorkout();
}
}

function finishWorkout(){
data.activeWorkout.endTime=new Date();
data.workouts.push(data.activeWorkout);
data.activeWorkout=null;
save();
alert("Workout Saved!");
renderHome();
}

// ---------- HISTORY ----------

function viewHistory(){
const app=document.getElementById("app");
app.innerHTML=`
<button onclick="renderHome()">‚Üê Back</button>
<h2>Workout History</h2>
${data.workouts.map((w,i)=>`
<div class="card">
${w.name||"Workout"}<br>
${new Date(w.startTime).toLocaleString()}
</div>
`).join("")}
`;
}

renderHome();

</script>
</body>
</html>